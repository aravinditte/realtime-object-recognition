<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Real-Time Object Detection</title>
  <link rel="stylesheet" href="/static/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <header class="header">
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <div style="display:flex;align-items:center;gap:10px"><div style="width:28px;height:28px;border-radius:6px;background:linear-gradient(180deg,#6aa6ff,#4988ef)"></div><div style="font-weight:700;letter-spacing:.3px">Real‑Time Object Detection</div></div>
      <div class="status"><span id="dot" class="dot warn"></span><span id="status">Connecting...</span></div>
    </div>
  </header>

  <main class="container" style="padding-top:16px">
    <div class="row">
      <section class="col col-7 grid">
        <div class="panel">
          <div class="head">Live Detection Feed</div>
          <div class="body">
            <div class="video-shell">
              <div id="placeholder" class="placeholder">
                <div style="font-size:14px;margin-bottom:6px">Click Start Camera to begin real-time detection</div>
                <div class="small">If prompt appears, allow the browser to use your camera.</div>
              </div>
              <img id="videoFeed" alt="Live Feed" />
              <video id="processedVideo" controls preload="metadata"></video>
              <video id="cameraSrc"></video>
            </div>
            <div class="actions" style="margin-top:12px">
              <button id="btnStart" class="btn primary">Start Camera</button>
              <button id="btnStop" class="btn danger">Stop Camera</button>
              <button id="btnStopProc" class="btn warn">Stop Processing</button>
              <span class="tag">FPS <span id="fpsLabel">0</span></span>
              <span class="tag">Objects <span id="objLabel">0</span></span>
              <span class="tag">Proc <span id="procLabel">0 ms</span></span>
              <span class="tag">Frames <span id="framesLabel">0</span></span>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="head">Upload Video / Image</div>
          <div class="body">
            <div id="uploadZone" class="panel" style="border-style:dashed; text-align:center; padding:24px; background:var(--panel-2)">
              <div style="margin-bottom:8px">Drag & drop here or click to browse</div>
              <div class="small">MP4, AVI, MOV, MKV, WebM, JPG, PNG, BMP, TIFF • Max 50MB</div>
              <input id="fileInput" type="file" accept="video/*,image/*" style="display:none" />
            </div>

            <div id="uploadWrap" style="margin-top:14px; display:none">
              <div class="kv"><span id="progressText" class="small">Processing...</span><span id="progressStats" class="small"></span></div>
              <div class="progress"><div id="progressBar"></div></div>
              <div class="small" id="detectionStats" style="margin-top:6px"></div>
            </div>
          </div>
        </div>
      </section>

      <aside class="col col-5 grid">
        <div class="panel">
          <div class="head">Statistics</div>
          <div class="body">
            <div class="kv"><span>Current FPS</span><span id="fpsLabelSide"> <span id="fpsLabelDup">—</span></span></div>
            <div class="kv"><span>Objects (last frame)</span><span id="objLabelSide"> <span id="objLabelDup">—</span></span></div>
            <div class="kv"><span>Processing Time</span><span id="procLabelSide"> <span id="procLabelDup">—</span></span></div>
            <div class="kv"><span>Total Frames</span><span id="framesLabelSide"> <span id="framesLabelDup">—</span></span></div>
            <div class="kv"><span>Total Detections (video)</span><span id="totalDet">0</span></div>
            <div class="small" style="margin-top:8px">Tip: Use Frame Skip and Quality to improve performance.</div>
          </div>
        </div>

        <div class="panel">
          <div class="head">Settings</div>
          <div class="body">
            <div style="margin-bottom:10px">
              <label>Confidence: <span id="confidenceVal">0.30</span></label>
              <input id="confidence" class="input-range" type="range" min="0.1" max="0.9" step="0.05" value="0.30" />
            </div>
            <div style="margin-bottom:10px">
              <label>Frame Skip: <span id="frameSkipVal">0</span></label>
              <input id="frameSkip" class="input-range" type="range" min="0" max="5" step="1" value="0" />
            </div>
            <div style="margin-bottom:10px">
              <label>Image Quality: <span id="qualityVal">75</span>%</label>
              <input id="quality" class="input-range" type="range" min="30" max="95" step="5" value="75" />
            </div>
            <div class="small">These settings affect the client‑side frame capture and payload size.</div>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
